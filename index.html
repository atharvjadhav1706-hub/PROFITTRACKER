<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Pro Fit Tracker</title>
    
    <style>
        /* --- 1. RESET & BASE --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --bg-grad-1: #c4b5fd; --bg-grad-2: #a5f3fc; --bg-grad-3: #fda4af;
            --glass-bg: rgba(255, 255, 255, 0.65);
            --glass-border: rgba(255, 255, 255, 0.8);
            --text-main: #2d3436;
            --text-muted: #636e72;
            --card-bg: #ffffff;
            --success: #10b981;
            --danger: #f43f5e;
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        .dark {
            --text-main: #f5f5f5; --text-muted: #a3a3a3;        
            --glass-bg: rgba(20, 20, 20, 0.85); --glass-border: rgba(255, 255, 255, 0.08); 
            --card-bg: #171717; --bg-grad-1: #000000; --bg-grad-2: #1c1c1c; --bg-grad-3: #0f172a;         
        }

        body {
            font-family: var(--font-family); margin: 0; padding: 0; color: var(--text-main);
            background: linear-gradient(-45deg, var(--bg-grad-1), var(--bg-grad-2), var(--bg-grad-1), var(--bg-grad-3));
            background-size: 300% 300%; animation: gradientBG 20s ease infinite; min-height: 100vh; transition: 0.5s;
        }

        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        /* --- 2. LAYOUT --- */
        .app-container { max-width: 480px; margin: 0 auto; padding-bottom: 30px; }
        .section { padding: 24px; display: flex; flex-direction: column; gap: 20px; animation: fadeUp 0.5s ease; }
        .hidden { display: none !important; }
        .flex-row { display: flex; align-items: center; }
        .flex-col { display: flex; flex-direction: column; }
        .justify-between { justify-content: space-between; }
        
        /* --- 3. COMPONENTS --- */
        .glass { background: var(--glass-bg); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 24px; padding: 20px; }
        .btn-icon { width: 44px; height: 44px; border-radius: 50%; border: 1px solid var(--glass-border); background: var(--glass-bg); color: var(--text-main); cursor: pointer; display: flex; align-items: center; justify-content: center; }

        /* Progress Bar & Goal Pulse */
        .progress-track { height: 18px; background: rgba(0,0,0,0.1); border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .dark .progress-track { background: rgba(255,255,255,0.1); }
        .progress-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #a855f7, #3b82f6); transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); }
        
        .goal-met { 
            background: linear-gradient(90deg, #10b981, #34d399) !important; 
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.6);
            animation: pulseGoal 1.2s infinite;
        }
        @keyframes pulseGoal { 0%, 100% { transform: scaleY(1); } 50% { transform: scaleY(1.1); } }

        /* Particles */
        .animate-particle { position: fixed; width: 8px; height: 8px; border-radius: 50%; pointer-events: none; z-index: 9999; animation: particle 1.2s forwards; }
        @keyframes particle { from { opacity: 1; transform: translate(-50%, -50%) scale(1.5); } to { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0); } }

        /* Weight Graph */
        .chart-container { width: 100%; height: 180px; margin-top: 10px; }
        .chart-line { fill: none; stroke: var(--primary); stroke-width: 3; stroke-linecap: round; }
        .chart-dot { fill: #fff; stroke: var(--primary); stroke-width: 2; }
        
        input[type="number"] { width: 75px; padding: 8px; border-radius: 10px; border: none; background: rgba(128,128,128,0.1); color: var(--text-main); font-weight: bold; text-align: right; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div id="app" class="app-container">
    
    <section id="home-view" class="section">
        <div class="flex-row justify-between">
            <div class="flex-col">
                <span style="font-size: 11px; font-weight: 800; opacity: 0.6; text-transform: uppercase;">Fitness Tracker</span>
                <input type="text" id="user-name" oninput="localStorage.setItem('userName', this.value)" style="background:transparent; border:none; color:var(--text-main); font-size:28px; font-weight:900; padding:0;" value="ATHARV">
            </div>
            <button onclick="toggleTheme()" class="btn-icon"><svg id="theme-icon" style="width:20px; height:20px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path id="theme-path" d=""/></svg></button>
        </div>

        <div onclick="switchView('weight-view')" class="glass flex-row justify-between" style="cursor:pointer">
            <div>
                <span style="font-size:10px; font-weight:800; opacity:0.6;">CURRENT WEIGHT</span>
                <div class="flex-row" style="align-items:baseline">
                    <span id="home-weight" style="font-size:32px; font-weight:900;">--</span>
                    <span style="margin-left:4px; font-weight:800; opacity:0.6;">KG</span>
                </div>
            </div>
            <div style="text-align:right">
                <span id="weight-trend" style="font-size:10px; font-weight:800; color:var(--success)">TRACK PROGRESS</span>
                <p id="last-weight-date" style="font-size:10px; opacity:0.5; margin:4px 0 0 0">No data</p>
            </div>
        </div>

        <div class="glass">
            <div class="flex-row justify-between">
                <span style="font-weight:900; font-size:18px;">Calories</span>
                <span id="calorie-percent-text" style="font-weight:900; color:var(--primary)">0%</span>
            </div>
            <div class="progress-track">
                <div id="calorie-bar" class="progress-fill"></div>
            </div>
            <div class="flex-row justify-between" style="font-size:12px; font-weight:800; opacity:0.7;">
                <span id="display-calories">0 kcal</span>
                <span>Goal: 1800</span>
            </div>
        </div>

        <div class="flex-row gap-2" style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
            <button onclick="switchView('gym-view')" class="glass" style="border:none; cursor:pointer; text-align:center;">
                <span style="font-weight:900; font-size:16px; display:block;">GYM</span>
                <span style="font-size:10px; opacity:0.6;">WORKOUT LOG</span>
            </button>
            <button onclick="switchView('meal-view')" class="glass" style="border:none; cursor:pointer; text-align:center;">
                <span style="font-weight:900; font-size:16px; display:block;">MEALS</span>
                <span style="font-size:10px; opacity:0.6;">DIET PLAN</span>
            </button>
        </div>
    </section>

    <section id="weight-view" class="section hidden">
        <div class="flex-row gap-2" onclick="switchView('home-view')" style="cursor:pointer">
            <svg style="width:20px;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M15 19l-7-7 7-7"/></svg>
            <h2 style="margin:0; font-size:18px; font-weight:900;">Weekly Weight</h2>
        </div>

        <div class="glass">
            <div id="weight-chart" class="chart-container"></div>
        </div>

        <div id="weight-log-list" class="flex-col" style="gap:10px;">
            </div>
    </section>

    <section id="gym-view" class="section hidden">
        <button onclick="switchView('home-view')" class="glass">Back to Home</button>
        <h2 style="font-weight:900;">Gym Routine</h2>
        <p style="opacity:0.6;">Check previous code for exercise list.</p>
    </section>
    
    <section id="meal-view" class="section hidden">
        <button onclick="switchView('home-view')" class="glass">Back to Home</button>
        <h2 style="font-weight:900;">Meal Plan</h2>
        <p style="opacity:0.6;">Check previous code for full diet list.</p>
    </section>

</div>

<script>
/* ---------------- CONSTANTS ---------------- */
const CALORIE_LIMIT = 1800;
const todayKey = new Date().toDateString();

/* ---------------- THEME ---------------- */
function toggleTheme() {
    const isDark = document.documentElement.classList.toggle('dark');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
    updateThemeIcon();
}
function updateThemeIcon() {
    const isDark = document.documentElement.classList.contains('dark');
    const path = document.getElementById('theme-path');
    path.setAttribute('d', isDark ? 
        "M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707m0-11.314l.707.707m11.314 11.314l.707.707M12 5a7 7 0 100 14 7 7 0 000-14z" : 
        "M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z");
}

/* ---------------- PARTICLES & EFFECTS ---------------- */
function triggerBlast(x,y,color) {
    const colors = color === "green" ? ["#10b981", "#34d399", "#fff"] : ["#a855f7", "#3b82f6", "#fff"];
    for(let i=0; i<30; i++) {
        const p = document.createElement("div");
        p.className = "animate-particle";
        p.style.left = x + "px"; p.style.top = y + "px";
        p.style.background = colors[Math.floor(Math.random()*colors.length)];
        const a = Math.random() * 360, s = Math.random() * 200 + 100;
        p.style.setProperty("--tx", Math.cos(a)*s + "px");
        p.style.setProperty("--ty", Math.sin(a)*s + "px");
        document.body.appendChild(p);
        setTimeout(() => p.remove(), 1200);
    }
}

function celebrateGoal() {
    if(localStorage.getItem("goal_done_today") === todayKey) return;
    triggerBlast(window.innerWidth/2, window.innerHeight/3, "green");
    if(navigator.vibrate) navigator.vibrate(200);
    localStorage.setItem("goal_done_today", todayKey);
}

/* ---------------- DASHBOARD ---------------- */
function updateDashboard() {
    const total = parseInt(localStorage.getItem("calories") || "0");
    document.getElementById("display-calories").innerText = total + " kcal";
    
    const pct = Math.min((total / CALORIE_LIMIT) * 100, 100);
    const bar = document.getElementById("calorie-bar");
    bar.style.width = pct + "%";
    document.getElementById("calorie-percent-text").innerText = Math.round(pct) + "%";
    
    if(pct >= 100) {
        bar.classList.add("goal-met");
        celebrateGoal();
    } else {
        bar.classList.remove("goal-met");
    }
}

/* ---------------- WEIGHT LOGIC ---------------- */
function renderWeightView() {
    const list = document.getElementById("weight-log-list");
    const logs = JSON.parse(localStorage.getItem("weight_logs") || "{}");
    list.innerHTML = "";

    for(let i=0; i<4; i++) {
        const key = "week" + i;
        const val = logs[key] || "";
        list.innerHTML += `
            <div class="glass flex-row justify-between" style="padding:15px">
                <span style="font-weight:900;">Week ${i+1}</span>
                <div class="flex-row gap-2">
                    <input type="number" step="0.1" value="${val}" 
                        onchange="saveWeight('${key}', this.value)">
                    <span style="font-size:11px; font-weight:800; opacity:0.5;">KG</span>
                </div>
            </div>`;
    }
    updateHomeWeight(logs);
    drawGraph(logs);
}

function saveWeight(k, v) {
    const logs = JSON.parse(localStorage.getItem("weight_logs") || "{}");
    logs[k] = v;
    localStorage.setItem("weight_logs", JSON.stringify(logs));
    localStorage.setItem("weight_ts", new Date().toLocaleDateString());
    updateHomeWeight(logs);
    drawGraph(logs);
}

function updateHomeWeight(logs) {
    const values = Object.values(logs).filter(v => v !== "");
    const latest = values.length > 0 ? values[values.length - 1] : "--";
    document.getElementById("home-weight").innerText = latest;
    document.getElementById("last-weight-date").innerText = localStorage.getItem("weight_ts") || "No data";
}

function drawGraph(logs) {
    const container = document.getElementById("weight-chart");
    const values = [0,1,2,3].map(i => parseFloat(logs["week"+i])).filter(v => !isNaN(v));
    
    if(values.length < 2) {
        container.innerHTML = `<p style="text-align:center; font-size:11px; opacity:0.5; padding-top:80px;">Need 2 weights to plot graph</p>`;
        return;
    }

    const min = Math.min(...values) - 1, max = Math.max(...values) + 1;
    const w = container.clientWidth, h = container.clientHeight, pad = 20;
    
    const points = values.map((v, i) => {
        const x = pad + (i / (values.length - 1)) * (w - pad * 2);
        const y = h - pad - ((v - min) / (max - min)) * (h - pad * 2);
        return `${x},${y}`;
    }).join(" ");

    container.innerHTML = `
        <svg width="100%" height="100%">
            <polyline points="${points}" class="chart-line" />
            ${values.map((v, i) => {
                const [x,y] = points.split(" ")[i].split(",");
                return `<circle cx="${x}" cy="${y}" r="4" class="chart-dot" />`;
            }).join("")}
        </svg>`;
}

/* ---------------- NAVIGATION ---------------- */
function switchView(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
    window.scrollTo(0,0);
    if(id === 'weight-view') renderWeightView();
}

/* ---------------- INIT ---------------- */
if(localStorage.getItem('theme') === 'dark') document.documentElement.classList.add('dark');
if(!localStorage.getItem('userName')) localStorage.setItem('userName', 'ATHARV');
document.getElementById('user-name').value = localStorage.getItem('userName');

updateThemeIcon();
updateDashboard();
renderWeightView();

</script>
</body>
</html>
